package models

import "time"

// VulnerabilityType 脆弱性の種類
type VulnerabilityType string

const (
	VulnerabilityTypeSQLInjection VulnerabilityType = "sql_injection"
	VulnerabilityTypeXSS          VulnerabilityType = "xss"
)

// Severity 脆弱性の重大度
type Severity string

const (
	SeverityLow      Severity = "low"
	SeverityMedium   Severity = "medium"
	SeverityHigh     Severity = "high"
	SeverityCritical Severity = "critical"
)

// Vulnerability 脆弱性情報モデル
type Vulnerability struct {
	ID             int              `json:"id" db:"id"`
	ScanID         int              `json:"scan_id" db:"scan_id"`
	Type           VulnerabilityType `json:"type" db:"type"`
	Severity       Severity         `json:"severity" db:"severity"`
	Location       string           `json:"location" db:"location"`
	Payload        *string          `json:"payload,omitempty" db:"payload"`
	Description    *string          `json:"description,omitempty" db:"description"`
	Recommendation *string          `json:"recommendation,omitempty" db:"recommendation"`
	CreatedAt      time.Time        `json:"created_at" db:"created_at"`
}

